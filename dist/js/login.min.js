"use strict";$(function(){function a(o){var t="",a=o.width(),n=o.height(),e=o[0],r=e.getContext("2d");e.width=a,e.height=n;for(var h="A,B,C,E,F,G,H,J,K,L,M,N,P,Q,R,S,T,W,X,Y,Z,1,2,3,4,5,6,7,8,9,0".split(","),l=h.length,s=0;s<=3;s++){var i=Math.floor(Math.random()*l),d=10*Math.random()*Math.PI/180,m=h[i];t+=m.toLowerCase();var c=4+13*s,f=15;r.font="bold 16px 微软雅黑",r.translate(c,f),r.rotate(d),r.fillStyle="rgb(0,0,0)",r.fillText(m,0,0),r.rotate(-d),r.translate(-c,-f)}console.log(t);for(s=0;s<=2;s++)r.strokeStyle=u(),r.beginPath(),r.moveTo(Math.random()*a,Math.random()*n),r.lineTo(Math.random()*a,Math.random()*n),r.stroke();for(s=0;s<=30;s++){r.strokeStyle=u(),r.beginPath();c=Math.random()*a,f=Math.random()*n;r.moveTo(c,f),r.lineTo(c+1,f+1),r.stroke()}return t}function u(){return"rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")"}$(".btn").on("click",function(){var o=$(".username").val(),t=$(".psw").val();$.post("http://47.104.244.134:8080/userlogin.do",{name:o,password:t},function(o){if(console.log($(".yzm").val()),$(".yzm").val()!=show_num)$(".error").fadeIn(),show_num=a($("#canvas"));else if($(".error").fadeOut(),0==o.code){$.cookie("token",o.data.token,{path:"/",expires:7});$.cookie("token");$(window).attr("location","index.html")}else show_num=a($("#canvas")),alert("用户名或密码错误，请重试")})}),show_num=a($("#canvas")),$(".change").on("click",function(){show_num=a($("#canvas"))})});