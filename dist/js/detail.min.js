"use strict";$(function(){$(".select").on("mouseover",function(){$(".select_pop").css({display:"block"})}),$(".select").on("mouseout",function(){$(".select_pop").css({display:"none"})}),$(".select_pop").on("mouseout",function(){$(".select_pop").css({display:"none"})}),$(".select_pop li").on("click",function(){$(".select a").html($(this).text()),$(".select_pop").css({display:"none"})}),$(".midarea").on("mouseover",function(){$(".zoom").css({display:"block"}),$(".bigarea").css({display:"block"})}),$(".midarea").on("mouseout",function(){$(".zoom").css({display:"none"}),$(".bigarea").css({display:"none"})}),$(".midarea").on("mousemove",function(t){var o=$(".midarea").width()-$(".zoom").width(),e=$(".midarea").height()-$(".zoom").height(),n=t.pageX-$(".midarea").offset().left,s=t.pageY-$(".midarea").offset().top,a=n-$(".zoom").width()/2,i=s-$(".zoom").height()/2;a=a<=0?0:o<=a?o:a,i=i<=0?0:e<=i?e:i,$(".zoom").css({left:a+"px"}),$(".zoom").css({top:i+"px"}),$(".bigarea img").css({left:-$(".zoom").position().left/$(".midarea").width()*$(".bigarea img").width()}),$(".bigarea img").css({top:-$(".zoom").position().top/$(".midarea").height()*$(".bigarea img").height()})});var e="";$(".shurukuang").on("input",function(){$(".result").css({display:"block"}),$.ajax({type:"get",url:"https://search.kongfz.com/sug/suggest_server.jsp?_=1570494898129",data:{query:$(".shurukuang").val()},dataType:"jsonp",success:function(t){for(var o in t)e+='\n\t\t\t\t\t\t<li class="searchitem">'+t[o]+"</li>\n\t\t\t\t";$(".result").append(e)}}),$(".result li").on("click",function(){$(".shurukuang").val($(this).text()),$(".result").css({display:"none"})}),$(".shurukuang").on("blur",function(){setTimeout(function(){$(".result").css({display:"none"})},100)})}),$(".all").on("mouseover",function(){$(".sub_box").css({display:"block"}).stop().animate({height:"511px"})}),$(".sub_box").on("mouseover",function(){$(".sub_box").css({display:"block"}).stop().animate({height:"511px"})}),$(".sub_box").on("mouseout",function(){$(".sub_box").stop().animate({height:"0px"}),$(".sub_box").css({display:"none"}),$(".all").on("mouseout",function(){$(".sub_box").css({display:"none"}).stop().animate({height:"0px"})})});var t=window.location.search;$.ajax({type:"get",url:"http://47.104.244.134:8080/goodsbyid.do"+t,success:function(t){$(".midarea").append("<img src="+t.picurl+">"),$(".bigarea").append("<img src="+t.picurl+">"),$(".pub").append("上架时间："+t.pubdate),$("h2").append(t.name),$(".price").append(t.price)}}),$(".numadd,.numdel,.cartadd").click(function(t){t.preventDefault()}),$(".numadd").on("click",function(){var t=$(".numinput").val();t++,$(".numinput").val(t),console.log($(".num"))}),$(".numdel").on("click",function(){var t=$(".numinput").val();t--,$(".numinput").val(t),t<1&&$(".numinput").val(1)});var o=$.cookie("token"),n=0;$.ajax({type:"get",url:"http://47.104.244.134:8080/cartlist.do",data:{token:o},success:function(t){for(var o in t)n+=t[o].count;99<n?(console.log(n),n=99,$(".num").text("99+")):$(".num").text(n)}}),$(".cartadd").on("click",function(){var e=$.cookie("token"),n=window.location.search.split("=")[1],s=$(".numinput").val();$.ajax({type:"get",url:"http://47.104.244.134:8080/cartlist.do",data:{token:e},success:function(t){for(var o in t)if(t[o].gid==n)return console.log("已存在"),void $.ajax({type:"get",url:"http://47.104.244.134:8080/cartupdate.do",data:{gid:n,id:t[o].id,token:e,num:s},success:function(){$(".spnum").text(s),$(".tishi").fadeIn(),setTimeout(function(){$(".tishi").fadeOut()},1500)}});console.log("不存在"),1==s?(console.log("数量一件"),$.ajax({type:"get",url:"http://47.104.244.134:8080/cartsave.do",data:{gid:n,token:e},success:function(){console.log("加入1件"),$(".spnum").text("1"),$(".tishi").fadeIn(),setTimeout(function(){$(".tishi").fadeOut()},1500)}})):(console.log("要加入的数量不止一件"),$.ajax({type:"get",url:"http://47.104.244.134:8080/cartsave.do",data:{gid:n,token:e},success:function(t){console.log("先加入购物车"),$.ajax({type:"get",url:"http://47.104.244.134:8080/cartlist.do",data:{token:e},success:function(t){for(var o in console.log("先加入购物车成功"),t)t[o].gid==n&&(console.log("已加入一件"),console.log(n,t[o].id,t[o].gid),$.ajax({type:"get",url:"http://47.104.244.134:8080/cartupdate.do",data:{gid:n,id:t[o].id,token:e,num:s-1},success:function(t){console.log(t),console.log("再加入"+s+"件"),$(".spnum").text(s),$(".tishi").fadeIn(),setTimeout(function(){$(".tishi").fadeOut()},1500)}}))}})}}))}});var a=0;$.ajax({type:"get",url:"http://47.104.244.134:8080/cartlist.do",data:{token:e},success:function(t){for(var o in t)a+=t[o].count;99<a?(console.log(a),a=99,$(".num").text("99+")):$(".num").text(a)}})})});